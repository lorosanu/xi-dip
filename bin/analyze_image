#!/usr/bin/ruby
# -*- encoding : utf-8 -*-

$LOAD_PATH.unshift 'lib/'
require 'xi/dip'

if ARGV.length < 1
  puts 'Usage ./bin/analyze_image <image>'
  exit
end

Xi::DIP::Config.load_yaml('conf/xi_dip.yml')

data = File.open(ARGV[0]).read

img = Xi::DIP::Image.new(data)
puts "Size: #{img.size}"
puts "Format: #{img.format}"
puts "Transparent: #{img.alpha?}"
puts 'Colors:'
img.color_histogram
   .sort_by {|_k, v| -v }
   .each {|k, v| puts "  - #{k.join('|')}: #{v}" }


puts 'Exif:'
img.exif.each {|k, v| puts "  - #{k}: #{v}" }
